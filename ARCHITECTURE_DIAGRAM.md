# Architecture Diagram: Question Parser & Step 5 Integration

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Assignment Pipeline                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  INPUT: Assignment HTML/PDF/Word                               â”‚
â”‚    â†“                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Step 1: Document Ingestion (parseFiles.ts)             â”‚  â”‚
â”‚  â”‚  - Extract text from PDF/Word                           â”‚  â”‚
â”‚  â”‚  - Result: Raw assignment text + HTML markup            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†“                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Step 2: Question Parsing â˜… NEW (questionParser.ts)     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ Input: Assignment HTML                             â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ Process:                                           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  1. cleanHTML() â†’ plain text                       â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  2. segmentText() â†’ question segments              â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  3. isQuestion() â†’ filter actual questions         â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  4. For each question:                             â”‚ â”‚  â”‚
â”‚  â”‚  â”‚     - detectQuestionType() â†’ type                  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚     - classifyBloomLevel() â†’ verb mapping          â”‚ â”‚  â”‚
â”‚  â”‚  â”‚     - calculateComplexity() â†’ Flesch-Kincaid       â”‚ â”‚  â”‚
â”‚  â”‚  â”‚     - calculateSimilarity() â†’ Jaccard index        â”‚ â”‚  â”‚
â”‚  â”‚  â”‚     - isMultiPart() â†’ sub-questions               â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  5. recalculateNoveltyScores() â†’ context-aware    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ Output: ParsedQuestion[] with metadata             â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†“                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Step 3: Tag Analysis (analyzeTags.ts)                  â”‚  â”‚
â”‚  â”‚  - Extract pedagogical tags                            â”‚  â”‚
â”‚  â”‚  - Can use parsed questions for better tagging         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†“                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Step 4: Student Simulation (simulateStudents.ts)        â”‚  â”‚
â”‚  â”‚  - Simulate student personas with parsed questions      â”‚  â”‚
â”‚  â”‚  - Generate per-question feedback                       â”‚  â”‚
â”‚  â”‚  - Track confusion, time, success per question          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†“                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Step 5: Rewrite & Compare â˜… ENHANCED (RewriteResults)  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ Original Assignment                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â””â”€ formatForStudentView()                          â”‚ â”‚  â”‚
â”‚  â”‚  â”‚    â””â”€ Clean HTML â†’ rendered text                  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚       â””â”€ Display in left column (gray border)     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ Rewritten Assignment                              â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â””â”€ formatForStudentView()                          â”‚ â”‚  â”‚
â”‚  â”‚  â”‚    â””â”€ Clean HTML â†’ rendered text                  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚       â””â”€ Display in right column (green border)   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ Comparison UI:                                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”œâ”€ Summary of Changes                             â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”œâ”€ Applied Improvement Tags                       â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”œâ”€ HTML Toggle (optional, hidden by default)     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â”œâ”€ Comparison Tips                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ â””â”€ Continue to Export button                      â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†“                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Step 6: Export                                          â”‚  â”‚
â”‚  â”‚  - Download as PDF/DOCX                                 â”‚  â”‚
â”‚  â”‚  - Share with students                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Question Parser Detailed Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  parseQuestionsFromAssignment(assignmentHTML)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  1. cleanHTML(html)                                             â”‚
â”‚     â”œâ”€ Remove <script>, <style> tags                            â”‚
â”‚     â”œâ”€ Convert <br>, <p>, <div>, <li> â†’ newlines               â”‚
â”‚     â”œâ”€ Remove remaining HTML tags                               â”‚
â”‚     â”œâ”€ Decode HTML entities (&nbsp; â†’ space, etc.)             â”‚
â”‚     â””â”€ Return: "1. Question text\n2. Question text\n..."       â”‚
â”‚        â†“                                                         â”‚
â”‚  2. segmentText(cleanedText)                                    â”‚
â”‚     â”œâ”€ Strategy 1: Split by numbered delimiters (1., 2., 3.)   â”‚
â”‚     â”œâ”€ Strategy 2: Split by lettered delimiters (a), b), c))   â”‚
â”‚     â”œâ”€ Strategy 3: Split by question indicators                â”‚
â”‚     â”‚              (What, Explain, Circle, Choose, etc.)       â”‚
â”‚     â”œâ”€ Strategy 4: Split by bullet points (-, â€¢)               â”‚
â”‚     â”œâ”€ Strategy 5: Split by line breaks                        â”‚
â”‚     â””â”€ Return: ["1. Question one", "2. Question two", ...]     â”‚
â”‚        â†“                                                         â”‚
â”‚  3. Process each segment:                                       â”‚
â”‚     â”œâ”€ isQuestion(segment) â†’ boolean                            â”‚
â”‚     â”‚  â””â”€ Only process actual questions                         â”‚
â”‚     â”‚     â†“                                                      â”‚
â”‚     â”œâ”€ detectQuestionType(text)                                 â”‚
â”‚     â”‚  â”œâ”€ Look for (A), (B), (C), ... â†’ "multiple_choice"      â”‚
â”‚     â”‚  â”œâ”€ Look for "Explain", "Briefly", ... â†’ "short_answer"  â”‚
â”‚     â”‚  â”œâ”€ Look for underscores â†’ "fill_in_blank"               â”‚
â”‚     â”‚  â”œâ”€ Look for "Match" â†’ "matching"                        â”‚
â”‚     â”‚  â””â”€ Look for length/indicators â†’ "essay"                 â”‚
â”‚     â”‚     â†“                                                      â”‚
â”‚     â”œâ”€ classifyBloomLevel(text)                                 â”‚
â”‚     â”‚  â”œâ”€ Extract action verbs                                  â”‚
â”‚     â”‚  â”œâ”€ Check against verb mappings                           â”‚
â”‚     â”‚  â”‚  â”œâ”€ Remember: "list", "recall", "define", ...         â”‚
â”‚     â”‚  â”‚  â”œâ”€ Understand: "explain", "describe", "classify"     â”‚
â”‚     â”‚  â”‚  â”œâ”€ Apply: "solve", "use", "calculate"                â”‚
â”‚     â”‚  â”‚  â”œâ”€ Analyze: "compare", "distinguish", "examine"      â”‚
â”‚     â”‚  â”‚  â”œâ”€ Evaluate: "judge", "critique", "appraise"        â”‚
â”‚     â”‚  â”‚  â””â”€ Create: "design", "develop", "hypothesize"        â”‚
â”‚     â”‚  â””â”€ Default to "Understand" if ambiguous                 â”‚
â”‚     â”‚     â†“                                                      â”‚
â”‚     â”œâ”€ calculateComplexity(text)                                â”‚
â”‚     â”‚  â”œâ”€ Count words â†’ calculate average word length           â”‚
â”‚     â”‚  â”œâ”€ Count sentences â†’ calculate average sentence length   â”‚
â”‚     â”‚  â”œâ”€ Detect academic jargon                                â”‚
â”‚     â”‚  â”œâ”€ Apply grade-level adjustment (if provided)            â”‚
â”‚     â”‚  â””â”€ Normalize to 0.0-1.0 range                            â”‚
â”‚     â”‚     â†“                                                      â”‚
â”‚     â”œâ”€ calculateSimilarity(text, previousTexts)                 â”‚
â”‚     â”‚  â”œâ”€ Tokenize both texts (words only)                      â”‚
â”‚     â”‚  â”œâ”€ Calculate Jaccard index: |Aâˆ©B| / |AâˆªB|               â”‚
â”‚     â”‚  â””â”€ Return 0.0 (unique) to 1.0 (identical)               â”‚
â”‚     â”‚     â†“                                                      â”‚
â”‚     â”œâ”€ isMultiPart(text)                                        â”‚
â”‚     â”‚  â”œâ”€ Look for (a), (b), (c) patterns                       â”‚
â”‚     â”‚  â”œâ”€ Look for i), ii), iii) patterns                       â”‚
â”‚     â”‚  â””â”€ Return boolean                                        â”‚
â”‚     â”‚     â†“                                                      â”‚
â”‚     â””â”€ Count words â†’ ProblemLength                              â”‚
â”‚        â†“                                                         â”‚
â”‚  4. Recalculate novelty scores:                                 â”‚
â”‚     â”œâ”€ For each question Q:                                     â”‚
â”‚     â”‚  â”œâ”€ Novelty = Average dissimilarity to all other Qs      â”‚
â”‚     â”‚  â””â”€ Higher novelty = unique content                       â”‚
â”‚     â””â”€ Return updated questions with novelty scores             â”‚
â”‚        â†“                                                         â”‚
â”‚  Result: ParsedQuestion[]                                       â”‚
â”‚  â”œâ”€ QuestionId: "q1", "q2", ...                                â”‚
â”‚  â”œâ”€ Text: clean question text (no HTML)                        â”‚
â”‚  â””â”€ Metadata:                                                   â”‚
â”‚     â”œâ”€ BloomLevel                                               â”‚
â”‚     â”œâ”€ LinguisticComplexity (0.0-1.0)                          â”‚
â”‚     â”œâ”€ NoveltyScore (0.0-1.0)                                  â”‚
â”‚     â”œâ”€ SimilarityToPrevious (0.0-1.0)                          â”‚
â”‚     â”œâ”€ ProblemLength (word count)                               â”‚
â”‚     â”œâ”€ MultiPart (boolean)                                      â”‚
â”‚     â””â”€ QuestionType                                             â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Step 5 Comparison UI Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  <RewriteResults>                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Props:                                                          â”‚
â”‚  â”œâ”€ originalText: string (HTML)                                 â”‚
â”‚  â”œâ”€ rewrittenText: string (HTML)                                â”‚
â”‚  â”œâ”€ summaryOfChanges: string                                    â”‚
â”‚  â”œâ”€ appliedTags: Array<{name, description}>                     â”‚
â”‚  â”œâ”€ isLoading: boolean                                          â”‚
â”‚  â””â”€ onNext: () => void                                          â”‚
â”‚     â†“                                                            â”‚
â”‚  State:                                                          â”‚
â”‚  â””â”€ showHtml: boolean (controls toggle)                         â”‚
â”‚     â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Header Section                                         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Step 5: Assignment Comparison                          â”‚   â”‚
â”‚  â”‚ Review how your assignment has been improved.           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚     â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Summary Section                                        â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ğŸ“‹ Summary of Changes                                  â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ [Light blue box with rewriter's explanation]           â”‚   â”‚
â”‚  â”‚ "Simplified vocabulary, reduced sentence length,       â”‚   â”‚
â”‚  â”‚  added visual formatting for clarity..."               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚     â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Tags Section                                           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ âœ¨ Applied Improvements                                â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ [Simplify-Language] [Break-Multipart] [...]           â”‚   â”‚
â”‚  â”‚ [Blue badge pills showing applied rules]               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚     â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Toggle Section                                         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ [ğŸ‘€ Show HTML] button                                  â”‚   â”‚
â”‚  â”‚ Student view (how it will appear to learners)          â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ When toggled: [ğŸ“‹ Show HTML]                          â”‚   â”‚
â”‚  â”‚ Raw markup (for technical review)                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚     â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Comparison Grid (2 columns)                            â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚     â”‚ Original (LEFT)     â”‚ Rewritten (RIGHT)         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Hdr â”‚ ğŸ“„ Original         â”‚ âœ¨ Rewritten (GREEN)      â”‚   â”‚
â”‚  â”‚     â”‚ Assignment          â”‚ Assignment                â”‚   â”‚
â”‚  â”‚     â”‚                     â”‚ (âœ¨ GREEN BORDER)        â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚     â”‚ [Student View]      â”‚ [Student View]            â”‚   â”‚
â”‚  â”‚ Cnt â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚   â”‚
â”‚  â”‚     â”‚ Question 1...       â”‚ Question 1...             â”‚   â”‚
â”‚  â”‚     â”‚ Question 2...       â”‚ Question 2...             â”‚   â”‚
â”‚  â”‚     â”‚ [HTML Hidden]       â”‚ [HTML Hidden] (GREEN)    â”‚   â”‚
â”‚  â”‚     â”‚                     â”‚                           â”‚   â”‚
â”‚  â”‚     â”‚ When HTML toggle ON:â”‚ When HTML toggle ON:      â”‚   â”‚
â”‚  â”‚     â”‚ <html>...           â”‚ <html>... (GREEN)        â”‚   â”‚
â”‚  â”‚     â”‚ </html>             â”‚ </html>                   â”‚   â”‚
â”‚  â”‚     â”‚                     â”‚                           â”‚   â”‚
â”‚  â”‚     â”‚ [Gray border]       â”‚ [Green border]            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚     â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Tips Section                                           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ğŸ’¡ Tips: Compare clarity, tone, structure, and         â”‚   â”‚
â”‚  â”‚ readability. The rewritten version should be easier    â”‚   â”‚
â”‚  â”‚ for your students to understand and engage with.       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚     â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Action Section                                         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                  [âœ“ Continue to Export â†’]              â”‚   â”‚
â”‚  â”‚                  (Green button, right-aligned)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Type Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ParsedQuestion (NEW TYPE)                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  {                                                                â”‚
â”‚    QuestionId: string;          // "q1", "q2", ...              â”‚
â”‚    Text: string;                 // Clean text (no HTML)         â”‚
â”‚    OriginalHTML?: string;         // For reference               â”‚
â”‚                                                                    â”‚
â”‚    Metadata: {                                                    â”‚
â”‚      BloomLevel:                 // "Remember" | "Understand"   â”‚
â”‚                                   // "Apply" | "Analyze"        â”‚
â”‚                                   // "Evaluate" | "Create"      â”‚
â”‚                                                                    â”‚
â”‚      LinguisticComplexity: number; // 0.0 (simple) to          â”‚
â”‚                                     // 1.0 (complex)            â”‚
â”‚                                     // Flesch-Kincaid based     â”‚
â”‚                                                                    â”‚
â”‚      NoveltyScore: number;         // 0.0 (duplicated) to       â”‚
â”‚                                     // 1.0 (unique)             â”‚
â”‚                                     // Based on similarity       â”‚
â”‚                                                                    â”‚
â”‚      SimilarityToPrevious: number; // 0.0 (unique) to           â”‚
â”‚                                     // 1.0 (identical)          â”‚
â”‚                                     // Jaccard index            â”‚
â”‚                                                                    â”‚
â”‚      ProblemLength: number;        // Word count                â”‚
â”‚                                                                    â”‚
â”‚      MultiPart: boolean;           // Has (a), (b), (c)        â”‚
â”‚                                                                    â”‚
â”‚      QuestionType:                 // "multiple_choice"         â”‚
â”‚        'multiple_choice' |          // "short_answer"           â”‚
â”‚        'short_answer' |             // "essay"                  â”‚
â”‚        'essay' |                    // "fill_in_blank"          â”‚
â”‚        'fill_in_blank' |            // "matching"               â”‚
â”‚        'matching' |                 // "other"                  â”‚
â”‚        'other';                                                   â”‚
â”‚    };                                                             â”‚
â”‚  }                                                                â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â†“ Uses

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PipelineState (EXTENDED)                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  {                                                                â”‚
â”‚    // Existing fields...                                         â”‚
â”‚    originalText: string;                                          â”‚
â”‚    rewrittenText: string;                                         â”‚
â”‚    studentFeedback: StudentFeedback[];                           â”‚
â”‚                                                                    â”‚
â”‚    // NEW FIELD (Integration Point)                              â”‚
â”‚    parsedQuestions: ParsedQuestion[];  // â† From parser          â”‚
â”‚                                                                    â”‚
â”‚    // NEW FIELD (For Step 5)                                     â”‚
â”‚    rewriteSummary: string;                                        â”‚
â”‚  }                                                                â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Function Call Graph

```
parseQuestionsFromAssignment()
  â”‚
  â”œâ”€â†’ cleanHTML()
  â”‚    â””â”€â†’ [DOM Element: textarea] (for entity decoding)
  â”‚
  â”œâ”€â†’ segmentText()
  â”‚    â”œâ”€â†’ [Regex: numbered delimiters]
  â”‚    â”œâ”€â†’ [Regex: lettered delimiters]
  â”‚    â”œâ”€â†’ [Regex: question indicators]
  â”‚    â”œâ”€â†’ [Regex: bullet points]
  â”‚    â””â”€â†’ [Regex: line breaks]
  â”‚
  â”œâ”€â†’ For each segment:
  â”‚    â”‚
  â”‚    â”œâ”€â†’ isQuestion()
  â”‚    â”‚    â””â”€â†’ [Check text patterns]
  â”‚    â”‚
  â”‚    â”œâ”€â†’ detectQuestionType()
  â”‚    â”‚    â”œâ”€â†’ [Check for option markers]
  â”‚    â”‚    â”œâ”€â†’ [Check for short answer phrases]
  â”‚    â”‚    â”œâ”€â†’ [Check for essay indicators]
  â”‚    â”‚    â”œâ”€â†’ [Check for blanks]
  â”‚    â”‚    â”œâ”€â†’ [Check for matching]
  â”‚    â”‚    â””â”€â†’ [Fallback: "other"]
  â”‚    â”‚
  â”‚    â”œâ”€â†’ classifyBloomLevel()
  â”‚    â”‚    â”œâ”€â†’ [Extract verbs]
  â”‚    â”‚    â””â”€â†’ [Map to Bloom levels]
  â”‚    â”‚
  â”‚    â”œâ”€â†’ calculateComplexity()
  â”‚    â”‚    â”œâ”€â†’ [Count words]
  â”‚    â”‚    â”œâ”€â†’ [Count sentences]
  â”‚    â”‚    â”œâ”€â†’ [Detect jargon]
  â”‚    â”‚    â””â”€â†’ [Normalize to 0.0-1.0]
  â”‚    â”‚
  â”‚    â”œâ”€â†’ calculateSimilarity()
  â”‚    â”‚    â”œâ”€â†’ [Tokenize both texts]
  â”‚    â”‚    â””â”€â†’ [Calculate Jaccard index]
  â”‚    â”‚
  â”‚    â”œâ”€â†’ isMultiPart()
  â”‚    â”‚    â””â”€â†’ [Regex: sub-question patterns]
  â”‚    â”‚
  â”‚    â””â”€â†’ [Create ParsedQuestion object]
  â”‚
  â””â”€â†’ recalculateNoveltyScores()
       â”œâ”€â†’ For each question:
       â”‚    â””â”€â†’ [Calculate average dissimilarity]
       â”‚
       â””â”€â†’ [Return updated array]


RewriteResults() component
  â”‚
  â”œâ”€â†’ formatForStudentView(originalText)
  â”‚    â”œâ”€â†’ [Remove script/style tags]
  â”‚    â”œâ”€â†’ [Convert block tags to newlines]
  â”‚    â”œâ”€â†’ [Remove HTML tags]
  â”‚    â”œâ”€â†’ [Decode entities]
  â”‚    â””â”€â†’ [Normalize whitespace]
  â”‚
  â”œâ”€â†’ formatForStudentView(rewrittenText)
  â”‚    â””â”€â†’ [Same as above]
  â”‚
  â”œâ”€â†’ <AssignmentView> (original, left column)
  â”‚    â”œâ”€â†’ Display formatForStudentView() by default
  â”‚    â””â”€â†’ Toggle to show original HTML if requested
  â”‚
  â”œâ”€â†’ <AssignmentView> (rewritten, right column, GREEN)
  â”‚    â”œâ”€â†’ Display formatForStudentView() by default
  â”‚    â””â”€â†’ Toggle to show rewritten HTML if requested
  â”‚
  â”œâ”€â†’ Render Summary Section
  â”œâ”€â†’ Render Applied Tags
  â”œâ”€â†’ Render Toggle Button
  â”œâ”€â†’ Render Tips Section
  â””â”€â†’ Render Action Button
```

---

## Integration Points

### Point 1: usePipeline.ts
```
Add after REWRITE step:

const parsed = parseQuestionsFromAssignment(rewrittenText);
setPipelineState(prev => ({
  ...prev,
  parsedQuestions: parsed,
}));
```

### Point 2: studentSimulations.ts
```
Update to use parsed questions instead of generic problems:

const feedback = questions.map(q => ({
  question: q.Text,
  bloomLevel: q.Metadata.BloomLevel,
  type: q.Metadata.QuestionType,
  estimatedTime: calculateTimeForQuestion(q),
  ...
}));
```

### Point 3: rewriteAssignment.ts
```
Apply rules per question:

const rewritten = parsedQuestions.map(q =>
  applyRewritingRules(q, rewriteRules)
);
```

---

## Success Metrics

âœ… Questions properly segmented
âœ… No HTML blobs remaining
âœ… Metadata accurate per-question
âœ… Step 5 shows clean content
âœ… Build succeeds with no errors
âœ… Full TypeScript type safety
âœ… Ready for production deployment
